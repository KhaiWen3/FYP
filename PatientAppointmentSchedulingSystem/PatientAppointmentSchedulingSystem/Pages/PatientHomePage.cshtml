@page
@model PatientAppointmentSchedulingSystem.Pages.PatientHomePageModel
@{
    Layout = "_PatientLayout";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Welcome to MediBook </title>

    <!-- ======= Google Font =======-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&amp;display=swap" rel="stylesheet">
    <!-- End Google Font-->
    <!-- ======= Styles =======-->
    <link href="/vendors/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="/vendors/bootstrap-icons/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="/vendors/glightbox/glightbox.min.css" rel="stylesheet">
    <link href="/vendors/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="/vendors/aos/aos.css" rel="stylesheet">
    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <!-- End Styles-->
    <!-- ======= Theme Style =======-->
    <link href="/css/patient.css" rel="stylesheet">
    <!-- End Theme Style-->
    <!-- ======= Apply theme =======-->
    <script>
        // Apply the theme as early as possible to avoid flicker
        (function () {
            const storedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-bs-theme', storedTheme);
        })();
    </script>
    <!-- Use Tailwind CSS for a clean, responsive design -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .search-title {
            display: block; /* block so width works */
            width: 100%; /* fill available space */
            max-width: 1200px; /* but cap at 1200px */
            margin: 20px auto; /* center the block */
            text-align: center; /* center the text inside */
            background: color-mix(in srgb, var(--bs-secondary), transparent 70%);
            color: var(--bs-primary);
            padding: 12px 16px;
            border-radius: 7px;
            font-weight: 600;
            font-size: 48px;
        }

            .search-title .search-sub {
                font-size: 0.9rem; /* make it smaller */
                line-height: 1.4;
                margin: 6px 0 0; /* tighter spacing */
                color: var(--bs-body-color);
            }

    </style>
</head>

<body>
    <!-- ======= Site Wrap =======-->
    <div class="site-wrap">
        <!-- ======= Main =======-->
        <main>
            <section class="hero__v6 section" id="home" style="padding:100px 0 0 0 !important">

                <div class="container">
                    <div class="search-title" data-aos="fade-up" data-aos-delay="0">
                        <span class="text-uppercase">Welcome to MediBook</span>
                        <span>, @($"{Model.PatientDetails?.PatientLastName}".Trim().ToUpper())</span>
                        <p class="search-sub">Discover the best doctors, clinic and hospital the city nearest to you.</p>

                        <!-- Search Available Doctor -->
                        <section class="section services__v3" id="search">
                            <div class="container">
                                <form method="get">
                                    <div class="filter-section mb-3">
                                        <div class="row g-2 align-items-center">
                                            <!-- Search by Doctor Name-->
                                            <div class="col-md-6 col-6">
                                                <input type="text"
                                                       name="SearchDoctorName"
                                                       class="form-control"
                                                       value="@Model.SearchDoctorName"
                                                       placeholder="Search by a Doctor's Name ..." />
                                            </div>
                                            <!--Specialty Dropdown-->
                                            <div class="col-md-4 col-4">
                                                @* <select class="form-select" asp-for="SpecialtyId" asp-items="Model.SpecialtyOptions">
                                                <option value="">All specialties</option>
                                                </select> *@
                                                <select name="SpecialtyId" class="form-select">
                                                    <option value="0">All specialties</option>
                                                    @foreach (var s in Model.Specialties)
                                                    {
                                                        <option value="@s.SpecialtyId"
                                                                selected="@(Model.SpecialtyId == s.SpecialtyId ? "selected" : null)">
                                                            @s.SpecialtyName
                                                        </option>
                                                    }
                                                </select>
                                            </div>

                                            <div class="col-md-2 col-2">
                                                <button type="submit" class="btn btn-outline-primary w-100 d-flex align-items-center justify-content-center py-0">
                                                    Search
                                                </button>
                                                @* <button type="submit" id="cancelSearch" class="btn btn-outline-secondary">Cancel</button> *@
                                            </div>
                                        </div>
                                    </div>
                                </form>

                                <!--Display available doctor-->
                                @* Results: show Tailwind cards per doctor using your UI design *@
                                @if (!string.IsNullOrWhiteSpace(Model.SearchDoctorName) || Model.SpecialtyId.HasValue)
                                {
                                    if (Model.Doctors?.Any() == true)
                                    {
                                        <h6 class="mb-3">Available Doctors</h6>

                                        <!-- Responsive grid: 1 / 2 / 3 columns -->
                                        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                                            @foreach (var doctor in Model.Doctors)
                                            {
                                                // Build initials for the avatar circle (e.g., "Emily Carter" -> "EC")
                                                var initials = "";
                                                if (!string.IsNullOrWhiteSpace(doctor.DoctorFullName))
                                                {
                                                    initials = string.Join("",
                                                    doctor.DoctorFullName
                                                    .Split(' ', StringSplitOptions.RemoveEmptyEntries)
                                                    .Take(2) // first + last (or first two words)
                                                    .Select(w => char.ToUpperInvariant(w[0])));
                                                }

                                                <!-- Hidden data block -->
                                                <div id="doctor-data-@doctor.DoctorId" class="hidden"
                                                     data-doctorid="@doctor.DoctorId"
                                                     data-name="@doctor.DoctorFullName"
                                                     data-specialty="@doctor.DoctorSpecialtyName"
                                                     data-provider="@doctor.DoctorProviderName">
                                                    
                                                    @foreach (var slot in doctor.AvailabilitySlots.Where(s => s.AppointmentStatus == 0))
                                                    {
                                                        <input type="hidden" name="slotId" value="@slot.SlotId" />
                                                        <button type="submit" class="slot-btn" style="border:2px solid @(slot.AppointmentType.ToLower() == "video"? "#4CAF50" : "#9C27B0"); border-radius:6px;padding:10px;margin:5px 10px;background:#DEDEDE;"
                                                                data-slotid="@slot.SlotId"
                                                                data-doctor="@doctor.DoctorFullName"
                                                                data-date="@slot.AppointmentDate.ToString("dd MMMM yyyy")"
                                                                data-start="@slot.AptStartTime.ToString("hh:mm tt")"
                                                                data-end="@slot.AptEndTime.ToString("hh:mm tt")"
                                                                data-type="@slot.AppointmentType">
                                                            Date: @slot.AppointmentDate.ToString("dd MMMM yyyy") <br />
                                                            Time: @slot.AptStartTime.ToString("hh:mm tt") - @slot.AptEndTime.ToString("hh:mm tt") <br />
                                                            Type: @slot.AppointmentType
                                                        </button>
                                                    }
                                                </div>

                                                <div class="w-full max-w-sm mx-auto bg-white rounded-2xl shadow-xl overflow-hidden max-h-[500px] flex flex-col justify-between">
                                                    <div class="p-6">
                                                        <!-- Header -->
                                                        <div class="flex items-start gap-x-4">
                                                            <!-- Initials avatar (replace with real photo if you have it) -->
                                                            <div class="h-16 w-16 bg-blue-100 rounded-full flex-shrink-0 flex items-center justify-center text-blue-500 font-bold text-xl border-2 border-blue-400">
                                                                @initials
                                                            </div>

                                                            <div>
                                                                <h3 class="text-2xl font-bold text-gray-800 text-left">@doctor.DoctorFullName</h3>
                                                                @* <p class="text-sm text-indigo-600 font-semibold mt-1 text-left">@doctor.DoctorSpecialtyName</p> *@
                                                                @if (!string.IsNullOrWhiteSpace(doctor.DoctorSpecialtyName))
                                                                {
                                                                    <p class="text-sm text-indigo-600 font-semibold mt-1 text-left">@doctor.DoctorSpecialtyName</p>
                                                                }
                                                                @if (!string.IsNullOrWhiteSpace(doctor.DoctorMedicalService))
                                                                {
                                                                    <p class="text-sm text-indigo-600 font-semibold mt-1 text-left">@doctor.DoctorMedicalService</p>
                                                                }
                                                                @if (!string.IsNullOrWhiteSpace(doctor.DoctorProviderName))
                                                                {
                                                                    <p class="text-sm text-gray-500 text-left">@doctor.DoctorProviderName</p>
                                                                }
                                                            </div>
                                                        </div>

                                                        <div class="border-t border-gray-200 pt-3">
                                                            <p class="text-sm font-medium text-gray-400 uppercase tracking-wide">Available Appointment Type</p>

                                                            <!-- Available visit types FIRST -->
                                                            @if (doctor.AvailabilitySlots != null && doctor.AvailabilitySlots.Any())
                                                            {
                                                                var types = doctor.AvailabilitySlots
                                                                .Where(s => s.AppointmentStatus == 0)
                                                                .Select(s => s.AppointmentType)
                                                                .Distinct()
                                                                .ToList();

                                                                <div class="mt-2 flex flex-wrap gap-4">
                                                                    @foreach (var apttype in types)
                                                                    {
                                                                        var typeClass = apttype.Contains("Video") ? "video-color" : "inperson-color";

                                                                        <div class="flex items-center gap-2 legend-item">
                                                                            <div class="legend-color @typeClass"></div>
                                                                            <span class="font-medium text-black">@apttype</span>
                                                                        </div>
                                                                    }
                                                                </div>
                                                            }
                                                            else
                                                            {
                                                                <div class="mt-2 text-base text-gray-500">No available slot right now.</div>
                                                            }



                                                            <div class="mt-2 text-gray-600">
                                                                @if (!string.IsNullOrWhiteSpace(doctor.DoctorLanguageSpoken))
                                                                {
                                                                    var langs = doctor.DoctorLanguageSpoken.Split(',', StringSplitOptions.RemoveEmptyEntries | StringSplitOptions.TrimEntries);
                                                                    <div class="mt-2">
                                                                        @foreach (var language in langs)
                                                                        {
                                                                            <span class="lang-chip">@language</span>
                                                                        }
                                                                    </div>
                                                                }
                                                            </div>
                                                        </div>


                                                        <!-- Actions : will display doctor profile in popup method-->
                                                        <div class="action-buttons" class="mt-8 flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3">
                                                            <button type="button"
                                                                    class="openModalBtn btn btn-primary"
                                                                    data-doctorid="@doctor.DoctorId">
                                                                Book Appointment  <i class="bi bi-box-arrow-up-right"></i>
                                                            </button>
                                                        </div>

                                                        
                                                    </div>
                                                </div>
                                            }

                                        </div>
                                    }
                                    else
                                    {
                                        <h6>No matching doctors found.</h6>
                                    }
                                }
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Popup Container: View Doctor Profile & Make Appointment -->
                <div class="modal" id="doctorModal" style="display:none;">
                    <div class="modal-content" style="margin:auto; margin-top:150px !important;">
                        <form method="post" asp-page="/PatientHomePage" asp-page-handler="BookAppointment" onsubmit="return showConfirm(this)">
                            @Html.AntiForgeryToken()

                            <input type="hidden" name="slotId" id="modalSlotId"/>

                            <div class="modal-header">
                                <div class="modal-close" id="closeModalBtn">&times;</div>
                            </div>

                            <div class="modal-body">
                                <div asp-validation-summary="All" class="text-danger mb-2"></div>

                                <!-- hidden doctorid field -->
                                <div class="form-group">
                                    <input type="hidden" asp-for="Input.DoctorId" id="modalDoctorId" />
                                </div>

                                <!-- doctor info -->
                                <h2 id="modalDoctorName"></h2>
                                <p id="modalSpecialty"></p>
                                <p id="modalProvider" style="margin-bottom:0px !important"></p>

                                <!-- slot buttons will be injected here -->
                                <div class="slots-container" id="modalSlotsContainer" style="display:flex; justify-content:center;flex-wrap:wrap;"></div>

                            </div>
                        </form>
                    </div>
                </div>


                <!-- ======= Feature 4: Categorized Popular Medical Services =======-->
                <section class="section services__v3" id="services">
                    <div class="container">
                        <div class="row mb-5">
                            <div class="col-md-8 mx-auto text-center">
                                <span class="subtitle text-uppercase mb-3" data-aos="fade-up" data-aos-delay="0">Our Services</span>
                                <h2 class="mb-3" data-aos="fade-up" data-aos-delay="100">Everything You Need, All in One Place</h2>
                            </div>
                        </div>
                        <div class="row g-4">
                            <!--(1)-->
                            <div class="col-md-7" data-aos="fade-up" data-aos-delay="0">
                                <div class="service-card p-4 rounded-4 h-100 d-flex flex-column justify-content-between gap-5">
                                    <div>
                                        <!--Redirect to Login Page to make appointment/ A popup show how to make appointment/ Redirect to "How it Use"-->
                                        <h3 class="fs-5 mb-3">Quick Simple Appointment</h3>
                                        <p class="mb-4">Book, reschedule, or cancel appointments with any doctor in your network in under 30 seconds — no calls, no queues. Just instant confirmation.</p>
                                    </div><a class="special-link d-inline-flex gap-2 align-items-center text-decoration-none" href="#how-it-works"><span class="icons"><i class="bi bi-box-arrow-up-right"></i></span><span>Book Now</span></a>
                                </div>
                            </div>
                            <!--(2)-->
                            <div class="col-md-5" data-aos="fade-up" data-aos-delay="200">
                                <div class="service-card p-4 rounded-4 h-100 d-flex flex-column justify-content-between gap-5">
                                    <div>
                                        <!-- Show Video Visit Doctor Availability -->
                                        <h3 class="fs-5 mb-3">Online Doctor Consultation</h3>
                                        <p class="mb-4">Video consults with board-certified physicians, available day or night, with e-prescriptions sent instantly to your pharmacy.</p>
                                    </div><a class="special-link d-inline-flex gap-2 align-items-center text-decoration-none" href="#doctor-section"><span class="icons"><i class="bi bi-box-arrow-up-right"></i></span><span>Read more</span></a>
                                </div>
                            </div>
                        </div>
                        <div class="row g-4 mt-1">
                            <!--(3)-->
                            <div class="col-md-5" data-aos="fade-up" data-aos-delay="300">
                                <div class="service-card p-4 rounded-4 h-100 d-flex flex-column justify-content-between gap-2">
                                    <div>
                                        <!--Redirect to view Family Doctor Page-->
                                        <h3 class="fs-5 mb-3">Wide Partnership Network</h3>
                                        <p class="mb-4">We integrate with thousands of clinics, labs, insurers, and pharmacies so your care stays perfectly coordinated.</p>
                                    </div><a class="special-link d-inline-flex gap-2 align-items-center text-decoration-none" href="#service-provider"><span class="icons"><i class="bi bi-box-arrow-up-right"></i></span><span>Read more</span></a>
                                </div>
                            </div>
                            <!--(4)-->
                            <div class="col-md-7" data-aos="fade-up" data-aos-delay="500">
                                <div class="service-card p-4 rounded-4 h-100 d-flex flex-column justify-content-between gap-2">
                                    <div>
                                        <!--Redirect to view Insurance Plans Page-->
                                        <h3 class="fs-5 mb-3">Insurance Plans</h3>
                                        <p class="mb-4">Real-time eligibility checks and automated claims filing mean you see your exact out-of-pocket cost before you confirm the appointment—no surprises, ever.</p>
                                    </div>
                                    <a class="special-link d-inline-flex gap-2 align-items-center text-decoration-none" href="#insurance-provider"><span class="icons"><i class="bi bi-box-arrow-up-right"></i></span><span>Read more</span></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- Services-->

                <!-- ======= About =======-->
                <section class="about__v4 section" id="about">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-6 order-md-2">
                                <div class="row justify-content-end">
                                    <div class="col-md-11 mb-4 mb-md-0">
                                        <span class="subtitle text-uppercase mb-3" data-aos="fade-up" data-aos-delay="0">About MediBook</span>
                                        <h2 class="mb-4" data-aos="fade-up" data-aos-delay="100">MediBook is here to make healthcare easier by offering smart and simple appointment scheduling.</h2>
                                        <div data-aos="fade-up" data-aos-delay="200">
                                            <p>
                                                Our platform is designed to empower healthcare providers and patients alike, ensuring efficient appointment management.
                                            </p>
                                        </div>
                                        <h4 class="small fw-bold mt-4 mb-3" data-aos="fade-up" data-aos-delay="300">Key Values</h4>
                                        <ul class="d-flex flex-row flex-wrap list-unstyled gap-3 features" data-aos="fade-up" data-aos-delay="400">
                                            <li class="d-flex align-items-center gap-2"><span class="icon rounded-circle text-center"><i class="bi bi-check"></i></span><span class="text">Convenience</span></li>
                                            <li class="d-flex align-items-center gap-2"><span class="icon rounded-circle text-center"><i class="bi bi-check"></i></span><span class="text">Quick Access</span></li>
                                            <li class="d-flex align-items-center gap-2"><span class="icon rounded-circle text-center"><i class="bi bi-check"></i></span><span class="text">Integration & Security</span></li>
                                            <li class="d-flex align-items-center gap-2"><span class="icon rounded-circle text-center"><i class="bi bi-check"></i></span><span class="text">User-centric Design</span></li>
                                            <li class="d-flex align-items-center gap-2"><span class="icon rounded-circle text-center"><i class="bi bi-check"></i></span><span class="text">Transparency</span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="img-wrap position-relative">
                                    <div class="mission-statement p-4 rounded-4 d-flex gap-4" data-aos="fade-up" data-aos-delay="100">
                                        <div class="mission-icon text-center rounded-circle"><i class="bi bi-lightbulb fs-4"></i></div>
                                        <div>
                                            <h3 class="text-uppercase fw-bold">Mission Statement</h3>
                                            <p class="fs-5 mb-0">
                                                Our mission is  to enhance patient engagement, maximize scheduling efficiency, and ensure seamless healthcare access through a user-friendly, automated scheduling platform.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- End About-->
                <!-- ======= How it works =======-->
                <section class="section howitworks__v1" id="how-it-works">
                    <div class="container">
                        <div class="row mb-5">
                            <div class="col-md-6 text-center mx-auto">
                                <span class="subtitle text-uppercase mb-3" data-aos="fade-up" data-aos-delay="0">How it works</span>
                                <h2 data-aos="fade-up" data-aos-delay="100">How It Works</h2>
                                <p data-aos="fade-up" data-aos-delay="200">Our platform is designed to make managing your finances simple and efficient. Follow these easy steps to get started: </p>
                            </div>
                        </div>
                        <div class="row g-md-5">
                            <div class="col-md-6 col-lg-3">
                                <div class="step-card text-center h-100 d-flex flex-column justify-content-start position-relative" data-aos="fade-up" data-aos-delay="0">
                                    <div data-aos="fade-right" data-aos-delay="500"><img class="arch-line" src="/images/arch-line.svg" alt="FreeBootstrap.net image placeholder"></div><span class="step-number rounded-circle text-center fw-bold mb-5 mx-auto">1</span>
                                    <div>
                                        <h3 class="fs-5 mb-4">Sign Up</h3>
                                        <p>Visit our website sign up. Provide basic information to set up your secure account.</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="600">
                                <div class="step-card reverse text-center h-100 d-flex flex-column justify-content-start position-relative">
                                    <div data-aos="fade-right" data-aos-delay="1100"><img class="arch-line reverse" src="/images/arch-line-reverse.svg" alt="FreeBootstrap.net image placeholder"></div><span class="step-number rounded-circle text-center fw-bold mb-5 mx-auto">2</span>
                                    <h3 class="fs-5 mb-4">Search for a Doctor</h3>
                                    <p>Use search bar to find doctors by speciality, services or name.</p>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="1200">
                                <div class="step-card text-center h-100 d-flex flex-column justify-content-start position-relative">
                                    <div data-aos="fade-right" data-aos-delay="1700"><img class="arch-line" src="/images/arch-line.svg" alt="FreeBootstrap.net image placeholder"></div><span class="step-number rounded-circle text-center fw-bold mb-5 mx-auto">3</span>
                                    <h3 class="fs-5 mb-4">View Doctor Profile</h3>
                                    <p>Click on a doctor to view their full profile</p>
                                </div>
                            </div>
                            <div class="col-md-6 col-lg-3" data-aos="fade-up" data-aos-delay="1800">
                                <div class="step-card last text-center h-100 d-flex flex-column justify-content-start position-relative">
                                    <span class="step-number rounded-circle text-center fw-bold mb-5 mx-auto">4</span>
                                    <div>
                                        <h3 class="fs-5 mb-4">Book an Appointment</h3>
                                        <p>Select your preferred date, time and platform.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- End How it works-->
                <!-- ======= Display Top 5 Doctors + View More Button ======= -->
                <section class="stats__v3 section" id="doctor-section">
                    <div class="container">
                        <div class="row mb-5">
                            <div class="col-md-8 mx-auto text-center">
                                <span class="subtitle text-uppercase mb-3" style="font-weight:bold;color:#215C5C;background-color:#CCE8C933;font-size:12px;padding:5px 12px;display:inline-block;">
                                    Our Doctors
                                </span>
                                <h2 class="mb-3" data-aos="fade-up" data-aos-delay="100">Meet Our Specialists</h2>
                            </div>
                        </div>

                        <div class="row align-items-center p-4 rounded-4 shadow-sm med-block" style="background:#CCE8C933;" data-aos="fade-up" data-aos-delay="150">
                            <!-- Left: Grid -->
                            <div class="col-md-8">
                                <div class="p-3 p-md-4 rounded-4">
                                    <div class="row g-4 med-grid">
                                        @foreach (var item in Model.Doctors.Take(5).Select((d, i) => new { Doctor = d, Index = i }))
                                        {
                                            var delay = 150 + item.Index * 100;
                                            <div class="col-12 col-sm-6 col-lg-4" data-aos="fade-up" data-aos-delay="@delay">
                                                <div class="med-card text-center">
                                                    <div class="med-name">@item.Doctor.DoctorFullName</div>
                                                    @if (!string.IsNullOrWhiteSpace(item.Doctor.DoctorSpecialtyName))
                                                    {
                                                        <p class="med-spec">@item.Doctor.DoctorSpecialtyName</p>
                                                    }
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>

                            <!-- Right: CTA -->
                            <div class="col-md-4 text-center cta-wrap" data-aos="fade-up" data-aos-delay="700">
                                <a class="btn btn-primary py-2" href="/PatientLogin">View More Doctors <span class="icons"><i class="bi bi-box-arrow-up-right"></i></span></a>
                            </div>
                        </div>
                    </div>
                </section>
                <!-- End Stats-->
                <!--Display 10 Provider -->
                <section class="provider-showcase section" id="service-provider">
                    <div class="container">
                        <div class="row mb-5">
                            <div class="col-md-8 mx-auto text-center">
                                <span class="subtitle text-uppercase mb-3" style="font-weight:bold;color:#215C5C;background-color:#CCE8C933;font-size:12px;padding:5px 12px;display:inline-block;">
                                    Our Providers
                                </span>
                                <h2 class="mb-3" data-aos="fade-up" data-aos-delay="100">Recognized healthcare partners across our medical network.</h2>
                            </div>
                        </div>

                        <!-- Light grey rounded container -->
                        <div class="container" data-aos="fade-up" data-aos-delay="100">
                            <div class="rounded-4 p-3 p-md-4 shadow-sm" style="background:#CCE8C933;">
                                <div class="swiper init-swiper">
                                    <!-- Swiper config (same style as your reference) -->
                                    <script type="application/json" class="swiper-config">
                                        {
                                          "loop": true,
                                          "speed": 600,
                                          "autoplay": { "delay": 5000 },
                                          "slidesPerView": "auto",
                                          "spaceBetween": 24,
                                          "pagination": { "el": ".swiper-pagination", "type": "bullets", "clickable": true },
                                          "breakpoints": {
                                            "320": { "slidesPerView": 1, "spaceBetween": 16 },
                                            "1200": { "slidesPerView": 3, "spaceBetween": 24 }
                                          }
                                        }
                                    </script>

                                    <div class="swiper-wrapper">
                                        @foreach (var item in Model.Providers)
                                        {
                                            <!-- each provider = one slide -->
                                            <div class="swiper-slide">
                                                <div class="testimonial-item text-center">
                                                    <p style="margin-bottom: 10px;">
                                                        <i class="bi bi-quote quote-icon-left"></i>
                                                        @item.ProviderType
                                                        <i class="bi bi-quote quote-icon-right"></i>
                                                    </p>

                                                    <div class="testimonial-img fallback-avatar d-inline-flex align-items-center justify-content-center">
                                                        <img src="~/images/hospital.png" alt="hospitalIcon" width="40" />
                                                    </div>

                                                    <p style="margin-top:10px;"><b>@item.Name</b></p>
                                                </div>
                                            </div>
                                        }
                                    </div>

                                    <div class="swiper-pagination"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <!--end-->
                <!-- Insurance Plan -->
                <section class="stats__v3 section" id="insurance-provider">
                    <div class="container">
                        <div class="row mb-5">
                            <div class="col-md-8 mx-auto text-center">
                                <span class="subtitle text-uppercase mb-3" style="font-weight:bold;color:#215C5C;background-color:#CCE8C933;font-size:12px;padding:5px 12px;display:inline-block;">
                                    Our Insurance Providers
                                </span>
                                <h2 class="mb-3" data-aos="fade-up" data-aos-delay="100">Insurance Providers That Collaborate With Us</h2>
                            </div>
                        </div>

                        <div class="col align-items-center p-4 rounded-4 shadow-sm med-block justify-content-center" data-aos="fade-up" data-aos-delay="150" style="background:#CCE8C933;">
                            <!-- Left: Grid -->
                            <div class="row" style="margin:0px 50px;">
                                <div class="p-3 p-md-4 rounded-4">
                                    <div class="row g-2 align-items-center flex-nowrap">
                                        <form method="post" asp-page-handler="Search" class="d-flex">
                                            <div class="col flex-grow-1">
                                                <input id="searchInsuranceInput" name="InsuranceName"
                                                       class="form-control text-center"
                                                       placeholder="Enter Insurance Provider Name" />
                                            </div>
                                            <div class="col-auto">
                                                <button type="submit" class="btn btn-primary py-2">
                                                    <i class="bi bi-search"></i>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col text-center">
                                    @if (Model.InsuranceList != null && Model.InsuranceList.Any())
                                    {
                                        <p class="mb-0">Search Results:</p>
                                        @foreach (var item in Model.InsuranceList)
                                        {
                                            <div>
                                                <p>@item.InsuranceProviderName</p>
                                            </div>
                                        }
                                    }
                                    else if (Model.InsuranceList != null)
                                    {
                                        <p class="mb-0">No Results Found.</p>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                @if (Model.InsuranceList?.Any() == true)
                {
                    <script>
                        // jump down to the section after postback
                        window.location.hash = "insurance-provider";
                    </script>
                }

                <!-- ======= FAQ =======-->
                <section class="section faq__v2" id="faq">
                    <div class="container">
                        <div class="row mb-4">
                            <div class="col-md-6 col-lg-7 mx-auto text-center">
                                <span class="subtitle text-uppercase mb-3" data-aos="fade-up" data-aos-delay="0">FAQ</span>
                                <h2 class="h2 fw-bold mb-3" data-aos="fade-up" data-aos-delay="0">Frequently Asked Questions</h2>
                                <p data-aos="fade-up" data-aos-delay="100">Utilize our tools to develop your concepts and bring your vision to life. Once complete, effortlessly share your creations.</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-8 mx-auto" data-aos="fade-up" data-aos-delay="200">
                                <div class="faq-content">
                                    <div class="accordion custom-accordion" id="accordionPanelsStayOpenExample">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne"> How do I book an appointment with a doctor? </button>
                                            </h2>
                                            <div class="accordion-collapse collapse show" id="panelsStayOpen-collapseOne">
                                                <div class="accordion-body">
                                                    You can search for a doctor by specialty or name using the search bar on our homepage. Once you find the doctor you want, click on their profile to view available time slots and click “Book Appointment” for your preferred date and time.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo"> Can I reschedule or cancel my appointment? </button>
                                            </h2>
                                            <div class="accordion-collapse collapse" id="panelsStayOpen-collapseTwo">
                                                <div class="accordion-body">Yes, after logging into your account, go to "My Appointments." From there, you can choose to reschedule or cancel any upcoming appointments, as long as it’s within the allowed time frame before the appointment.</div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree"> Can I choose a specific doctor or only by specialty? </button>
                                            </h2>
                                            <div class="accordion-collapse collapse" id="panelsStayOpen-collapseThree">
                                                <div class="accordion-body">
                                                    You can do both. You can search by specialty to see all available doctors in that field, or you can directly enter the doctor’s name if you already have a preferred physician.

                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFour" aria-expanded="false" aria-controls="panelsStayOpen-collapseFour"> Do I need to create an account to book an appointment?   </button>
                                            </h2>
                                            <div class="accordion-collapse collapse" id="panelsStayOpen-collapseFour">
                                                <div class="accordion-body">
                                                    Yes, creating an account ensures your appointments, medical history, and preferences are securely stored. It also allows you to manage, reschedule, or cancel your appointments easily.

                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseFive" aria-expanded="false" aria-controls="panelsStayOpen-collapseFive"> How do I know if my appointment is confirmed? </button>
                                            </h2>
                                            <div class="accordion-collapse collapse" id="panelsStayOpen-collapseFive">
                                                <div class="accordion-body">After you book an appointment, you will receive a confirmation message on the screen and via email. You can also check your appointment status anytime by logging into your account and visiting the "My Appointments" section.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End FAQ-->
                </section>
                <!-- End FAQ-->
            </section>
        </main>
    </div>

    <!-- ======= Back to Top =======-->
    <button id="back-to-top"><i class="bi bi-arrow-up-short"></i></button>
    <!-- End Back to top-->
    <!-- ======= Javascripts =======-->
    <script src="/vendors/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/vendors/gsap/gsap.min.js"></script>
    <script src="/vendors/imagesloaded/imagesloaded.pkgd.min.js"></script>
    <script src="/vendors/isotope/isotope.pkgd.min.js"></script>
    <script src="/vendors/glightbox/glightbox.min.js"></script>
    <script src="/vendors/swiper/swiper-bundle.min.js"></script>
    <script src="/vendors/aos/aos.js"></script>
    <script src="/vendors/purecounter/purecounter.js"></script>
    <script src="/js/custom.js"></script>
    <script src="/js/send_email.js"></script>
    <!-- End JavaScripts-->
</body>

<body>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <script>
        function confirmBooking(slotId) {
            if (confirm("Do you want to book this slot?")) {
                window.location.href = '/Booking/Confirm?slotId=' + slotId;
            }
        }

        function viewDoctorProfile() {
            const popup = document.getElementById('popup');
            popup.classList.toggle('hidden');
        }

        var selectedSlotId = null;


        document.addEventListener("DOMContentLoaded", function () {
            const modal = document.getElementById("doctorModal");
            const modalName = document.getElementById("modalDoctorName");
            const modalSpecialty = document.getElementById("modalSpecialty");
            const modalProvider = document.getElementById("modalProvider");
            const slotsContainer = document.getElementById("modalSlotsContainer");
            const slotIdInput = document.getElementById("modalSlotId");

            // Open modal and load doctor data
            document.querySelectorAll(".openModalBtn").forEach(btn => {
                btn.addEventListener("click", () => {
                    const doctorId = btn.dataset.doctorid;
                    const dataBlock = document.getElementById("doctor-data-" + doctorId);

                    modalName.textContent = dataBlock.dataset.name;
                    modalSpecialty.textContent = dataBlock.dataset.specialty;
                    modalProvider.textContent = dataBlock.dataset.provider;

                    slotsContainer.innerHTML = dataBlock.innerHTML; // inject slot buttons
                    modal.style.display = "block";
                });
            });

            // Close modal
            document.getElementById("closeModalBtn").addEventListener("click", () => {
                modal.style.display = "none";
            });
    
            // When slot button is clicked, set hidden slotId and submit form
            document.addEventListener("click", function (e) {
                if (e.target.classList.contains("slot-btn")) {
                    slotIdInput.value = e.target.dataset.slotid;
                }
            });
        });

        function showConfirm(form) {
            const doctor = document.getElementById("modalDoctorName").innerText;

            return confirm(`Are you sure you want to book Dr. ${doctor} slot?`);
        }
    </script>
</body>
</html>