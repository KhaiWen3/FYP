@page
@model PatientAppointmentSchedulingSystem.Pages.DoctorPatientListModel
@{
    Layout = "_DoctorLayout";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doctor Patient List - MediBook</title>

    <!-- ======= Google Font =======-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&amp;display=swap" rel="stylesheet">
    <!-- End Google Font-->
    <!-- ======= Styles =======-->
    <link href="/vendors/bootstrap/bootstrap.min.css" rel="stylesheet">
    <link href="/vendors/bootstrap-icons/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="/vendors/glightbox/glightbox.min.css" rel="stylesheet">
    <link href="/vendors/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="/vendors/aos/aos.css" rel="stylesheet">
    <!--I ADD THIS LINE⬇-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- End Styles-->
    <!-- ======= Theme Style =======-->
    <link href="/css/doctor.css" rel="stylesheet">
    <!-- End Theme Style-->

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <!-- ======= Apply theme =======-->
    <script>
        // Apply the theme as early as possible to avoid flicker
        (function() {
        const storedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-bs-theme', storedTheme);
        })();
    </script>
    <style>

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 8px 16px;
            border-radius: 5px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            border: none;
            font-size: 0.9rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

            .btn-primary:hover {
                background-color: var(--hover-color);
            }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray-medium);
            color: var(--dark-color);
        }

            .btn-outline:hover {
                background-color: var(--gray-light);
            }

        .btn-icon {
            margin-right: 8px;
        }

        .btn-secondary {
            background-color: var(--accent-color);
            color: white;
        }

            .btn-secondary:hover {
                background-color: #2389da;
            }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

            .btn-danger:hover {
                background-color: #c82333;
            }

        .patient-detail.card {
            border: 1px solid #ccc; /* light gray border */
            border-top: 0px !important;
            border-radius: 0px 0px 10px 10px; /* rounded corners */
            padding: 15px; /* inner spacing */
            margin-top: 10px; /* spacing above */
            background-color: #f9f9f9; /* light background */
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); /* subtle shadow */
            font-size: 14px;
            line-height: 1.6;
            margin: 0px 10px 5px;
        }

        .subpage-title {
            display: block; /* block so width works */
            width: 100%; /* fill available space */
            max-width: 1200px; /* but cap at 1200px */
            margin: 20px auto; /* center the block */
            text-align: center; /* center the text inside */
            background: #CFE3FF !important;
            color: #0056b3 !important;
            padding: 12px 16px;
            border-radius: 7px;
            font-weight: 600;
            font-size: 48px;
            padding-top: 24px !important;
            padding-bottom: 24px !important;
            background-color: rgba(var(--inverse-color-rgb), 0.03);
        }

            .subpage-title .subpage-sub {
                font-size: 0.9rem; /* make it smaller */
                line-height: 1.4;
                margin: 6px 0 0; /* tighter spacing */
                color: var(--bs-body-color);
            }
    </style>
</head>
<body>
    <!-- ======= Site Wrap =======-->
    <div class="site-wrap">
        <!-- ======= Main =======-->
        <main>
            <!-- Hero -->
            <section class="hero__v6 section" id="home" style="padding:100px 0 0 0 !important">

                <!-- Everything start here!!! -->
                <div class="container">
                    @* <h1 class="page-title">View Patient List</h1> *@
                    <div class="subpage-title" data-aos="fade-up" data-aos-delay="0">
                        <span>Upcoming Appointment</span>
                        @* <p class="subpage-sub">@Model.DoctorName</p> *@
                        @* <p class="search-sub">@Model.DoctorSpecialtyName</p> *@
                    </div>

                    <div class="content-wrapper">
                        @* <div class="sidebar">
                            <div class="doctor-profile"> *@
                                @* <img src="#" alt="Dr. Edalin Hendry" class="profile-image"> *@
                                @* <div class="status-indicator"></div> *@
                                <!--Retrieve-->
                                @* <div class="doctor-info">
                                    <div class="doctor-name">@Model.DoctorName</div>
                                    <div class="doctor-specialty">@Model.DoctorSpecialty</div>
                                    <div class="doctor-medicalservice">@Model.DoctorMedicalService</div>
                                </div> *@
                        @*     </div>
                        </div> *@

                        <div class="main-content">
                            <div class="tab-header">
                                <div class="tab active">Patient List</div>

                            </div>

                            <div class="section-header">
                                <h2 class="section-title">Select Patient Appointment</h2>
                            </div>

                            <div class="legend">
                                <div class="legend-item">
                                    <div class="legend-color video-color"></div>
                                    Video Visit
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color inperson-color"></div>
                                    In-Person Visit
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color isbooked-color"></div>
                                    Is Booked
                                </div>
                            </div>

                            <!--Display Slots Added-->
                            @if (Model.ListAvailableSlots != null && Model.ListAvailableSlots.Any())
                            {
                                @foreach (var dayGroup in Model.ListAvailableSlots.GroupBy(s => s.AppointmentDate.Date))
                                {
                                    <div class="slots-container">
                                        <div class="day-header">
                                            <div class="day-name">@dayGroup.Key.ToString("dddd, dd MMM yyyy")</div>
                                        </div>

                                        <div class="slots-grid">
                                            @foreach (var slot in dayGroup)
                                            {
                                                @* string slotClass = slot.AppointmentStatus == 1 ? "isbooked" : (slot.AppointmentType == "Video" ? "video" : "in-person"); *@

                                                <div class="slot-wrapper">
                                                    <button type="button" class="time-slot isbooked" data-slot-id="@slot.SlotId" style="width:100% !important;">
                                                        <div class="slot-time">
                                                            @slot.AptStartTime.ToString("HH:mm tt") - @slot.AptEndTime.ToString("HH:mm tt")

                                                        </div>
                                                        <div class="slot-type">
                                                            @if (slot.AppointmentType == "Video")
                                                            {
                                                                <p><i class="fas fa-video"></i> Video Visit</p>
                                                            }
                                                            else
                                                            {
                                                                <p><i class="fas fa-user-md"></i> In-Person</p>
                                                            }
                                                        </div>
                                                    </button>
                                                    <div class="patient-detail card" style="display:none;">
                                                        <span><b>Patient Name:</b> @slot.Patient.PatientLastName @slot.Patient.PatientFirstName</span><br />
                                                        <span><b>Phone:</b> @slot.Patient.PatientPhoneNum</span><br />
                                                        <span><b>Email:</b> @slot.Patient.PatientEmail</span>
                                                        <span>
                                                            @if (slot.AppointmentType.ToLower() == "video")
                                                            {
                                                                <p><strong>Link:</strong><a href="@slot.VideoVisitLink" target="_blank"> @slot.VideoVisitLink</a></p>
                                                            }
                                                        </span>
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                    </div>
                                }
                            }
                            else
                            {
                                <p>No slots available.</p>
                            }

                            @* <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 25px;"> *@
                            @*     <button class="btn btn-outline">Cancel</button> *@
                            @*     <button class="btn btn-primary">Save Changes</button> *@
                            @* </div> *@
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".time-slot").forEach(function (btn) {
            btn.addEventListener("click", function () {
                let detailDiv = this.nextElementSibling; // the patient-detail div
                if (detailDiv.style.display === "none") {
                    detailDiv.style.display = "block";
                } else {
                    detailDiv.style.display = "none";
                }
            });
        });
    });
</script>
</html>